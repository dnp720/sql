<html>
<script runat="server">

    Platform.Load("core", "1");

    var api = new Script.Util.WSProxy();
 
 try {

        var name = "MyNewQuery";

        var request = api.retrieve("QueryDefinition", ["CustomerKey", "ObjectID", "QueryText", "CategoryID"], {
            Property: "CustomerKey", 
            SimpleOperator: "equals",
            Value: "8499CF2C-992D-46AC-A807-B4660C6A3769" 
        });

            var objectID = request.Results[0].ObjectID,
            queryText = request.Results[0].QueryText,
            categoryID = request.Results[0].CategoryID;
        
        var updated_query =  queryText + ' where i.id is NOT null ';

        var request = api.retrieve("DataExtension", ["CustomerKey"], {
            Property: "Name",
            SimpleOperator: "equals",
            Value: "CatalogObjectETL_DP_IS"
        });

        var targetKey = request.Results[0].Customerkey;


        var config = {
            ObjectID: objectID,
            Description: "My updated query",
            CategoryID: categoryID,
            TargetType: "DE",
            TargetUpdateType: "Overwrite",
            QueryText: updated_query,
            DataExtensionTarget: {
                Name: "ContatctDeleCatalogObjectETL_DP_IStion_DP",
                CustomerKey: targetKey
            }
        };

        var result = api.updateItem("QueryDefinition", config);

        Write("version5"+Stringify(result));
  
 } catch(error) {

        Write(Stringify(error));
        
    } 

</script>

<body>
body
</body>
</html>
